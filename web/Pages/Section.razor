@page "/articles/{SectionRef}"

@using Models
@using Services

@inject HttpClient Http
@inject IArticlesService dataService
@inject IMarkdownService markdownService

@if (section == null)
{
    <h1>All Articles</h1>

    <div class="loading">Loading...</div>
} else
{
    <h1>@section.Title</h1>

    @if (sectionContent != null) {
        <div class="row">
            @sectionContent
        </div>
    }
    <div class="row">
    @foreach (var article in section.Articles)
    {
        <div class="col-md-6">
            <span class="oi oi-download" aria-hidden="true"></span>
            <span class="lead"><a href="">@article.Title</a></span></div>
    }
    </div>
}

@code {

    [Parameter]
    public string SectionRef { get; set; }

    private Models.Section section;

    private string sectionContent;
    protected override async Task OnParametersSetAsync()
    {
        section = await dataService.GetSection(SectionRef);

        sectionContent = await markdownService.GetContent(section.ContentUrl);
    }
}